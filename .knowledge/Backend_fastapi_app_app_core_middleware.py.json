{"is_source_file": true, "format": "Python", "description": "This file defines middleware classes for a FastAPI application, including request logging with authorization redaction and header configuration for iframe embedding support.", "external_files": ["starlette.middleware.base", "starlette.requests", "starlette.responses", "loguru"], "external_methods": ["loguru.logger.bind", "starlette.middleware.base.BaseHTTPMiddleware.__init__", "starlette.middleware.base.BaseHTTPMiddleware.dispatch", "starlette.requests.Request", "starlette.responses.Response", "starlette.responses.Response.headers"], "published": ["PreviewEmbeddingHeadersMiddleware", "RequestLoggingMiddleware"], "classes": [{"name": "PreviewEmbeddingHeadersMiddleware", "description": "Middleware to configure response headers for embedding the app in iframes, handling preview mode enablement with configurable security headers."}, {"name": "RequestLoggingMiddleware", "description": "Middleware that logs incoming requests and responses, redacting authorization headers to reduce sensitive data exposure."}], "methods": [{"name": "dict _redact_authorization(headers: Iterable[tuple[str, str]])", "description": "Sanitizes headers by redacting the Authorization header for logging.", "scope": "", "scopeKind": ""}, {"name": "PreviewEmbeddingHeadersMiddleware.__init__", "description": "Initializes the middleware with app, enabled status for preview embedding, and frame ancestors list."}, {"name": "PreviewEmbeddingHeadersMiddleware.dispatch", "description": "Handles the request, modifies response headers based on whether preview mode is enabled, and signals preview status."}, {"name": "RequestLoggingMiddleware.__init__", "description": "Initializes request logging middleware with optional enabling and path ignoring set."}, {"name": "RequestLoggingMiddleware.dispatch", "description": "Logs request headers with redacted authorization info and response status, unless disabled or in ignored paths."}, {"name": "__init__(self, app, enabled: bool = True, ignore_paths: Optional[set[str]] = None)", "scope": "RequestLoggingMiddleware", "scopeKind": "class", "description": "unavailable"}, {"name": "__init__(self, app, enabled: bool, frame_ancestors: str)", "scope": "PreviewEmbeddingHeadersMiddleware", "scopeKind": "class", "description": "unavailable"}, {"name": "Response dispatch(self, request: Request, call_next: Callable)", "scope": "RequestLoggingMiddleware", "scopeKind": "class", "description": "unavailable"}], "calls": ["call_next(request)", "logger.bind(path=request.url.path).info(...)"], "search-terms": ["PreviewEmbeddingHeadersMiddleware", "RequestLoggingMiddleware", "X-Frame-Options", "Content-Security-Policy", "Cross-Origin-Embedder-Policy", "Cross-Origin-Opener-Policy", "Authorization redaction", "middleware"], "state": 2, "file_id": 38, "knowledge_revision": 187, "git_revision": "88d5dbbb75c54c203f82bc561cbd513102bc70d1", "revision_history": [{"142": ""}, {"187": "88d5dbbb75c54c203f82bc561cbd513102bc70d1"}], "ctags": [{"_type": "tag", "name": "PreviewEmbeddingHeadersMiddleware", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/fastapi_app/app/core/middleware.py", "pattern": "/^class PreviewEmbeddingHeadersMiddleware(BaseHTTPMiddleware):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "RequestLoggingMiddleware", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/fastapi_app/app/core/middleware.py", "pattern": "/^class RequestLoggingMiddleware(BaseHTTPMiddleware):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/fastapi_app/app/core/middleware.py", "pattern": "/^    def __init__(self, app, enabled: bool = True, ignore_paths: Optional[set[str]] = None):$/", "language": "Python", "kind": "member", "signature": "(self, app, enabled: bool = True, ignore_paths: Optional[set[str]] = None)", "scope": "RequestLoggingMiddleware", "scopeKind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/fastapi_app/app/core/middleware.py", "pattern": "/^    def __init__(self, app, enabled: bool, frame_ancestors: str):$/", "language": "Python", "kind": "member", "signature": "(self, app, enabled: bool, frame_ancestors: str)", "scope": "PreviewEmbeddingHeadersMiddleware", "scopeKind": "class"}, {"_type": "tag", "name": "_redact_authorization", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/fastapi_app/app/core/middleware.py", "pattern": "/^def _redact_authorization(headers: Iterable[tuple[str, str]]) -> dict:$/", "language": "Python", "typeref": "typename:dict", "kind": "function", "signature": "(headers: Iterable[tuple[str, str]])"}, {"_type": "tag", "name": "dispatch", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/fastapi_app/app/core/middleware.py", "pattern": "/^    async def dispatch(self, request: Request, call_next: Callable) -> Response:$/", "language": "Python", "typeref": "typename:Response", "kind": "member", "signature": "(self, request: Request, call_next: Callable)", "scope": "PreviewEmbeddingHeadersMiddleware", "scopeKind": "class"}, {"_type": "tag", "name": "dispatch", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/fastapi_app/app/core/middleware.py", "pattern": "/^    async def dispatch(self, request: Request, call_next: Callable) -> Response:$/", "language": "Python", "typeref": "typename:Response", "kind": "member", "signature": "(self, request: Request, call_next: Callable)", "scope": "RequestLoggingMiddleware", "scopeKind": "class"}], "hash": "baa95b909643564bd12572b88f6006b8", "format-version": 4, "code-base-name": "Backend", "filename": "Backend/fastapi_app/app/core/middleware.py"}