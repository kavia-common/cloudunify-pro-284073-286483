{"is_source_file": true, "format": "JavaScript", "description": "This file manages PostgreSQL database connections using node-postgres, providing functions for executing queries, ensuring schema creation (tables and indexes), and handling connection pooling and errors, tailored for a specific backend application.", "external_files": ["pg"], "external_methods": ["URL()"], "published": ["query", "ensureSchema", "closePool", "pool"], "classes": [], "methods": [{"name": "sanitizeDatabaseUrl(raw)", "description": "Masks username and password in the database URL for secure logging.", "scope": "", "scopeKind": ""}, {"name": "query(text, params)", "description": "Executes a parameterized SQL query using the shared connection pool.", "scope": "", "scopeKind": ""}, {"name": "ensureSchema()", "description": "Creates tables and indexes if they do not already exist, setting up the database schema.", "scope": "", "scopeKind": ""}, {"name": "closePool()", "description": "Gracefully closes the database connection pool.", "scope": "", "scopeKind": ""}], "calls": ["pool.query", "query"], "search-terms": ["database connection", "PostgreSQL", "schema creation", "connection pool", "ensureSchema", "node-postgres", "pg"], "state": 2, "file_id": 13, "knowledge_revision": 103, "git_revision": "dba4240178822cb1fce1c0a7a0aa20147e9b5078", "revision_history": [{"27": ""}, {"39": ""}, {"78": "cdc4522b98f6436807c26ddb5ccd4c7d40f42e85"}, {"84": "cdc4522b98f6436807c26ddb5ccd4c7d40f42e85"}, {"103": "dba4240178822cb1fce1c0a7a0aa20147e9b5078"}], "ctags": [{"_type": "tag", "name": "application_name", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/db/index.js", "pattern": "/^  application_name: process.env.PGAPPNAME || 'cloudunify-pro-backend',$/", "language": "JavaScript", "kind": "property", "scope": "basePoolOpts", "scopeKind": "class"}, {"_type": "tag", "name": "basePoolOpts", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/db/index.js", "pattern": "/^const basePoolOpts = {$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "closePool", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/db/index.js", "pattern": "/^async function closePool() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "connectionTimeoutMillis", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/db/index.js", "pattern": "/^  connectionTimeoutMillis: parseInt(process.env.PGCONNECT_TIMEOUT_MS || '5000', 10),$/", "language": "JavaScript", "kind": "property", "scope": "basePoolOpts", "scopeKind": "class"}, {"_type": "tag", "name": "ensureSchema", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/db/index.js", "pattern": "/^async function ensureSchema() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "hasDatabaseUrl", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/db/index.js", "pattern": "/^const hasDatabaseUrl = !!process.env.DATABASE_URL;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "idleTimeoutMillis", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/db/index.js", "pattern": "/^  idleTimeoutMillis: parseInt(process.env.PGIDLE_TIMEOUT_MS || '30000', 10),$/", "language": "JavaScript", "kind": "property", "scope": "basePoolOpts", "scopeKind": "class"}, {"_type": "tag", "name": "max", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/db/index.js", "pattern": "/^  max: parseInt(process.env.PGPOOL_MAX || '10', 10),$/", "language": "JavaScript", "kind": "property", "scope": "basePoolOpts", "scopeKind": "class"}, {"_type": "tag", "name": "pool", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/db/index.js", "pattern": "/^const pool = new Pool(poolConfig);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "poolConfig", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/db/index.js", "pattern": "/^const poolConfig = hasDatabaseUrl$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "query", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/db/index.js", "pattern": "/^  query,$/", "language": "JavaScript", "kind": "field", "scope": "module.exports", "scopeKind": "class"}, {"_type": "tag", "name": "query", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/db/index.js", "pattern": "/^async function query(text, params) {$/", "language": "JavaScript", "kind": "function", "signature": "(text, params)"}, {"_type": "tag", "name": "rejectUnauthorized", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/db/index.js", "pattern": "/^  ssl: process.env.PGSSL === 'true' ? { rejectUnauthorized: false } : undefined,$/", "language": "JavaScript", "kind": "property", "scope": "basePoolOpts.ssl", "scopeKind": "class"}, {"_type": "tag", "name": "sanitizeDatabaseUrl", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/db/index.js", "pattern": "/^function sanitizeDatabaseUrl(raw) {$/", "language": "JavaScript", "kind": "function", "signature": "(raw)"}, {"_type": "tag", "name": "ssl", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/db/index.js", "pattern": "/^  ssl: process.env.PGSSL === 'true' ? { rejectUnauthorized: false } : undefined,$/", "language": "JavaScript", "kind": "class", "scope": "basePoolOpts", "scopeKind": "class"}], "hash": "72f69da12c7cb833ced061459fb5ee05", "format-version": 4, "code-base-name": "Backend", "filename": "Backend/src/db/index.js", "fields": [{"name": "application_name: process.env.PGAPPNAME || 'cloudunify-pro-backend',", "scope": "basePoolOpts", "scopeKind": "class", "description": "unavailable"}, {"name": "connectionTimeoutMillis: parseInt(process.env.PGCONNECT_TIMEOUT_MS || '5000', 10),", "scope": "basePoolOpts", "scopeKind": "class", "description": "unavailable"}, {"name": "idleTimeoutMillis: parseInt(process.env.PGIDLE_TIMEOUT_MS || '30000', 10),", "scope": "basePoolOpts", "scopeKind": "class", "description": "unavailable"}, {"name": "max: parseInt(process.env.PGPOOL_MAX || '10', 10),", "scope": "basePoolOpts", "scopeKind": "class", "description": "unavailable"}, {"name": "query,", "scope": "module.exports", "scopeKind": "class", "description": "unavailable"}, {"name": "ssl: process.env.PGSSL === 'true' ? { rejectUnauthorized: false } : undefined,", "scope": "basePoolOpts.ssl", "scopeKind": "class", "description": "unavailable"}]}