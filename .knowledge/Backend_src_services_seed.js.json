{"is_source_file": true, "format": "JavaScript", "description": "The file is a JavaScript module that provides functions for seeding data into a database: loading seed data, validating, normalizing, and upserting entities such as users, organizations, and resources. It also includes utility functions for directory traversal and schema management.", "external_files": ["../db"], "external_methods": ["query", "ensureSchema"], "published": ["ENTITIES", "loadEntityFromProjdefn", "seedEntity", "seedAll", "getSeedCounts"], "classes": [], "methods": [{"name": "isUUIDv4(str)", "description": "Checks if a string is a valid UUID v4.", "scope": "", "scopeKind": ""}, {"name": "isEmail(str)", "description": "Performs a basic validation to check if a string matches email format.", "scope": "", "scopeKind": ""}, {"name": "toISODateOrNow(val)", "description": "Converts a value to an ISO date or returns the current date if invalid or falsy.", "scope": "", "scopeKind": ""}, {"name": "chunkArray(arr, size)", "description": "Splits an array into chunks of specified size.", "scope": "", "scopeKind": ""}, {"name": "findProjdefnRoot()", "description": "Ascends directory tree to locate a '.projdefn' folder, with environment override.", "scope": "", "scopeKind": ""}, {"name": "walkDirCollectJsonFiles(dirPath)", "description": "Recursively collects all JSON files within a directory.", "scope": "", "scopeKind": ""}, {"name": "loadEntityFromProjdefn(entity)", "description": "Loads array data for a given entity from JSON files in the project definition directory.", "scope": "", "scopeKind": ""}, {"name": "validateAndNormalize(entity, records)", "description": "Validates and normalizes input records for entities; returns valid records and errors.", "scope": "", "scopeKind": ""}, {"name": "buildValuesPlaceholders(rows, cols)", "description": "Creates SQL placeholders for bulk insert queries.", "scope": "", "scopeKind": ""}, {"name": "upsertOrganizations(records)", "description": "Performs bulk upsert for organization records into the database.", "scope": "", "scopeKind": ""}, {"name": "upsertUsersById(records)", "description": "Bulk upsert users where IDs are known.", "scope": "", "scopeKind": ""}, {"name": "upsertUsersByEmail(records)", "description": "Bulk upsert users identified by email; generates IDs for new users.", "scope": "", "scopeKind": ""}, {"name": "upsertResources(records)", "description": "Bulk upsert resource records.", "scope": "", "scopeKind": ""}, {"name": "seedEntity(entity, bodyRecords)", "description": "Seeds data for a single entity, loading from provided records or from project definition files.", "scope": "", "scopeKind": ""}, {"name": "seedAll(payloadMap)", "description": "Sequentially seeds all entities in order: organizations, users, resources.", "scope": "", "scopeKind": ""}, {"name": "getSeedCounts()", "description": "Queries the database for counts of seeded entities.", "scope": "", "scopeKind": ""}], "calls": ["query", "ensureSchema", "loadEntityFromProjdefn", "validateAndNormalize", "upsertOrganizations", "upsertUsersById", "upsertUsersByEmail", "upsertResources"], "search-terms": ["seed", "upsert", "json files", "entity validation", "database seed", "directory traversal", "bulk insert", "entity normalization", "schema ensure"], "state": 2, "file_id": 15, "knowledge_revision": 106, "git_revision": "dba4240178822cb1fce1c0a7a0aa20147e9b5078", "revision_history": [{"31": ""}, {"40": "cdc4522b98f6436807c26ddb5ccd4c7d40f42e85"}, {"79": "cdc4522b98f6436807c26ddb5ccd4c7d40f42e85"}, {"106": "dba4240178822cb1fce1c0a7a0aa20147e9b5078"}], "ctags": [{"_type": "tag", "name": "ENTITIES", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^  ENTITIES,$/", "language": "JavaScript", "kind": "field", "scope": "module.exports", "scopeKind": "class"}, {"_type": "tag", "name": "ENTITIES", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^const ENTITIES = ['users', 'organizations', 'resources'];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "bcrypt", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^const bcrypt = require('bcryptjs');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "buildValuesPlaceholders", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function buildValuesPlaceholders(rows, cols) {$/", "language": "JavaScript", "kind": "function", "signature": "(rows, cols)"}, {"_type": "tag", "name": "chunkArray", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function chunkArray(arr, size) {$/", "language": "JavaScript", "kind": "function", "signature": "(arr, size)"}, {"_type": "tag", "name": "counts", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^  const counts = {$/", "language": "JavaScript", "kind": "class", "scope": "getSeedCounts", "scopeKind": "class"}, {"_type": "tag", "name": "errors", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^      errors: res.errors,$/", "language": "JavaScript", "kind": "property", "scope": "seedAll.results", "scopeKind": "class"}, {"_type": "tag", "name": "findProjdefnRoot", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function findProjdefnRoot() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "fs", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^const fs = require('fs');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "getSeedCounts", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^async function getSeedCounts() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "inserted", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^      inserted: res.inserted,$/", "language": "JavaScript", "kind": "property", "scope": "seedAll.results", "scopeKind": "class"}, {"_type": "tag", "name": "isEmail", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function isEmail(str) {$/", "language": "JavaScript", "kind": "function", "signature": "(str)"}, {"_type": "tag", "name": "isUUIDv4", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function isUUIDv4(str) {$/", "language": "JavaScript", "kind": "function", "signature": "(str)"}, {"_type": "tag", "name": "loadEntityFromProjdefn", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function loadEntityFromProjdefn(entity) {$/", "language": "JavaScript", "kind": "function", "signature": "(entity)"}, {"_type": "tag", "name": "organizations", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^    organizations: (orgs.rows[0] && orgs.rows[0].c) || 0,$/", "language": "JavaScript", "kind": "property", "scope": "getSeedCounts.counts", "scopeKind": "class"}, {"_type": "tag", "name": "path", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^const path = require('path');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "resources", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^    resources: (resources.rows[0] && resources.rows[0].c) || 0,$/", "language": "JavaScript", "kind": "property", "scope": "getSeedCounts.counts", "scopeKind": "class"}, {"_type": "tag", "name": "results", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^    results[entity] = {$/", "language": "JavaScript", "kind": "class", "scope": "seedAll", "scopeKind": "class"}, {"_type": "tag", "name": "seedAll", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^async function seedAll(payloadMap) {$/", "language": "JavaScript", "kind": "function", "signature": "(payloadMap)"}, {"_type": "tag", "name": "seedEntity", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^async function seedEntity(entity, bodyRecords) {$/", "language": "JavaScript", "kind": "function", "signature": "(entity, bodyRecords)"}, {"_type": "tag", "name": "skipped", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^      skipped: res.skipped,$/", "language": "JavaScript", "kind": "property", "scope": "seedAll.results", "scopeKind": "class"}, {"_type": "tag", "name": "toISODateOrNow", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function toISODateOrNow(val) {$/", "language": "JavaScript", "kind": "function", "signature": "(val)"}, {"_type": "tag", "name": "updated", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^      updated: res.updated,$/", "language": "JavaScript", "kind": "property", "scope": "seedAll.results", "scopeKind": "class"}, {"_type": "tag", "name": "upsertOrganizations", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^async function upsertOrganizations(records) {$/", "language": "JavaScript", "kind": "function", "signature": "(records)"}, {"_type": "tag", "name": "upsertResources", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^async function upsertResources(records) {$/", "language": "JavaScript", "kind": "function", "signature": "(records)"}, {"_type": "tag", "name": "upsertUsersByEmail", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^async function upsertUsersByEmail(records) {$/", "language": "JavaScript", "kind": "function", "signature": "(records)"}, {"_type": "tag", "name": "upsertUsersById", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^async function upsertUsersById(records) {$/", "language": "JavaScript", "kind": "function", "signature": "(records)"}, {"_type": "tag", "name": "users", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^    users: (users.rows[0] && users.rows[0].c) || 0,$/", "language": "JavaScript", "kind": "property", "scope": "getSeedCounts.counts", "scopeKind": "class"}, {"_type": "tag", "name": "validateAndNormalize", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function validateAndNormalize(entity, records) {$/", "language": "JavaScript", "kind": "function", "signature": "(entity, records)"}, {"_type": "tag", "name": "walkDirCollectJsonFiles", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function walkDirCollectJsonFiles(dirPath) {$/", "language": "JavaScript", "kind": "function", "signature": "(dirPath)"}], "hash": "2bb7db22dc8ea4666bc47b014a2d585f", "format-version": 4, "code-base-name": "Backend", "filename": "Backend/src/services/seed.js", "fields": [{"name": "ENTITIES,", "scope": "module.exports", "scopeKind": "class", "description": "unavailable"}, {"name": "errors: res.errors,", "scope": "seedAll.results", "scopeKind": "class", "description": "unavailable"}, {"name": "inserted: res.inserted,", "scope": "seedAll.results", "scopeKind": "class", "description": "unavailable"}, {"name": "organizations: (orgs.rows[0] && orgs.rows[0].c) || 0,", "scope": "getSeedCounts.counts", "scopeKind": "class", "description": "unavailable"}, {"name": "resources: (resources.rows[0] && resources.rows[0].c) || 0,", "scope": "getSeedCounts.counts", "scopeKind": "class", "description": "unavailable"}, {"name": "skipped: res.skipped,", "scope": "seedAll.results", "scopeKind": "class", "description": "unavailable"}, {"name": "updated: res.updated,", "scope": "seedAll.results", "scopeKind": "class", "description": "unavailable"}, {"name": "users: (users.rows[0] && users.rows[0].c) || 0,", "scope": "getSeedCounts.counts", "scopeKind": "class", "description": "unavailable"}]}