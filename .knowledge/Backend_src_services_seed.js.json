{"is_source_file": true, "format": "JavaScript", "description": "This file contains a module for seeding entities such as users, organizations, and resources into a database. It includes functions for loading data from JSON files within a project, validating and normalizing data, and performing bulk upsert operations into a PostgreSQL database. The module provides an API to seed individual entities or all entities in a specific order, and manages schema ensuring and data integrity.", "external_files": ["../db"], "external_methods": ["query"], "published": ["ENTITIES", "loadEntityFromProjdefn", "seedEntity", "seedAll"], "classes": [], "methods": [{"name": "isUUIDv4(str)", "description": "Checks whether a given string conforms to the UUID v4 format.", "scope": "", "scopeKind": ""}, {"name": "isEmail(str)", "description": "Performs a basic validation of email string format.", "scope": "", "scopeKind": ""}, {"name": "toISODateOrNow(val)", "description": "Converts a value to an ISO date string or returns the current date if invalid.", "scope": "", "scopeKind": ""}, {"name": "chunkArray(arr, size)", "description": "Splits an array into chunks of a specified size.", "scope": "", "scopeKind": ""}, {"name": "findProjdefnRoot()", "description": "Ascends the directory tree to locate a '.projdefn' directory for project configuration.", "scope": "", "scopeKind": ""}, {"name": "walkDirCollectJsonFiles(dirPath)", "description": "Recursively searches a directory for JSON files and returns their paths.", "scope": "", "scopeKind": ""}, {"name": "loadEntityFromProjdefn(entity)", "description": "Loads entity data arrays from JSON files within the project directory, matching filenames containing the entity name.", "scope": "", "scopeKind": ""}, {"name": "validateAndNormalize(entity, records)", "description": "Validates raw records for a given entity type and normalizes them, generating IDs where necessary.", "scope": "", "scopeKind": ""}, {"name": "buildValuesPlaceholders(rows, cols)", "description": "Constructs parameterized placeholders for bulk SQL insert statements.", "scope": "", "scopeKind": ""}, {"name": "upsertOrganizations(records)", "description": "Performs bulk insert or update (upsert) for organization records.", "scope": "", "scopeKind": ""}, {"name": "upsertUsersById(records)", "description": "Upserts user records with existing IDs into the database.", "scope": "", "scopeKind": ""}, {"name": "upsertUsersByEmail(records)", "description": "Upserts user records based on email when IDs are not provided.", "scope": "", "scopeKind": ""}, {"name": "upsertResources(records)", "description": "Bulk upsert of resource records.", "scope": "", "scopeKind": ""}, {"name": "seedEntity(entity, bodyRecords)", "description": "Seeds a specified entity (organizations, users, resources) using provided data or by loading default data from project files.", "scope": "", "scopeKind": ""}, {"name": "seedAll(payloadMap)", "description": "Seeds all entities in a fixed order to ensure referential integrity, aggregating results.", "scope": "", "scopeKind": ""}], "calls": ["query", "ensureSchema", "console.error", "console.log", "bcrypt.hashSync"], "search-terms": ["seed", "entities", "bulk insert", "upsert", "load from json", "project directory", "JSON files", "database schema", "UUID validation", "entity normalization"], "state": 2, "file_id": 15, "knowledge_revision": 79, "git_revision": "cdc4522b98f6436807c26ddb5ccd4c7d40f42e85", "revision_history": [{"31": ""}, {"40": "cdc4522b98f6436807c26ddb5ccd4c7d40f42e85"}, {"79": "cdc4522b98f6436807c26ddb5ccd4c7d40f42e85"}], "ctags": [{"_type": "tag", "name": "ENTITIES", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^  ENTITIES,$/", "language": "JavaScript", "kind": "field", "scope": "module.exports", "scopeKind": "class"}, {"_type": "tag", "name": "ENTITIES", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^const ENTITIES = ['users', 'organizations', 'resources'];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "bcrypt", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^const bcrypt = require('bcryptjs');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "buildValuesPlaceholders", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function buildValuesPlaceholders(rows, cols) {$/", "language": "JavaScript", "kind": "function", "signature": "(rows, cols)"}, {"_type": "tag", "name": "chunkArray", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function chunkArray(arr, size) {$/", "language": "JavaScript", "kind": "function", "signature": "(arr, size)"}, {"_type": "tag", "name": "errors", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^      errors: res.errors,$/", "language": "JavaScript", "kind": "property", "scope": "seedAll.results", "scopeKind": "class"}, {"_type": "tag", "name": "findProjdefnRoot", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function findProjdefnRoot() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "fs", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^const fs = require('fs');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "inserted", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^      inserted: res.inserted,$/", "language": "JavaScript", "kind": "property", "scope": "seedAll.results", "scopeKind": "class"}, {"_type": "tag", "name": "isEmail", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function isEmail(str) {$/", "language": "JavaScript", "kind": "function", "signature": "(str)"}, {"_type": "tag", "name": "isUUIDv4", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function isUUIDv4(str) {$/", "language": "JavaScript", "kind": "function", "signature": "(str)"}, {"_type": "tag", "name": "loadEntityFromProjdefn", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function loadEntityFromProjdefn(entity) {$/", "language": "JavaScript", "kind": "function", "signature": "(entity)"}, {"_type": "tag", "name": "path", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^const path = require('path');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "results", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^    results[entity] = {$/", "language": "JavaScript", "kind": "class", "scope": "seedAll", "scopeKind": "class"}, {"_type": "tag", "name": "seedAll", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^async function seedAll(payloadMap) {$/", "language": "JavaScript", "kind": "function", "signature": "(payloadMap)"}, {"_type": "tag", "name": "seedEntity", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^async function seedEntity(entity, bodyRecords) {$/", "language": "JavaScript", "kind": "function", "signature": "(entity, bodyRecords)"}, {"_type": "tag", "name": "skipped", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^      skipped: res.skipped,$/", "language": "JavaScript", "kind": "property", "scope": "seedAll.results", "scopeKind": "class"}, {"_type": "tag", "name": "toISODateOrNow", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function toISODateOrNow(val) {$/", "language": "JavaScript", "kind": "function", "signature": "(val)"}, {"_type": "tag", "name": "updated", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^      updated: res.updated,$/", "language": "JavaScript", "kind": "property", "scope": "seedAll.results", "scopeKind": "class"}, {"_type": "tag", "name": "upsertOrganizations", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^async function upsertOrganizations(records) {$/", "language": "JavaScript", "kind": "function", "signature": "(records)"}, {"_type": "tag", "name": "upsertResources", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^async function upsertResources(records) {$/", "language": "JavaScript", "kind": "function", "signature": "(records)"}, {"_type": "tag", "name": "upsertUsersByEmail", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^async function upsertUsersByEmail(records) {$/", "language": "JavaScript", "kind": "function", "signature": "(records)"}, {"_type": "tag", "name": "upsertUsersById", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^async function upsertUsersById(records) {$/", "language": "JavaScript", "kind": "function", "signature": "(records)"}, {"_type": "tag", "name": "validateAndNormalize", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function validateAndNormalize(entity, records) {$/", "language": "JavaScript", "kind": "function", "signature": "(entity, records)"}, {"_type": "tag", "name": "walkDirCollectJsonFiles", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function walkDirCollectJsonFiles(dirPath) {$/", "language": "JavaScript", "kind": "function", "signature": "(dirPath)"}], "hash": "0fff7cee65dc1adc245f757118f9ef0a", "format-version": 4, "code-base-name": "Backend", "filename": "Backend/src/services/seed.js", "fields": [{"name": "ENTITIES,", "scope": "module.exports", "scopeKind": "class", "description": "unavailable"}, {"name": "errors: res.errors,", "scope": "seedAll.results", "scopeKind": "class", "description": "unavailable"}, {"name": "inserted: res.inserted,", "scope": "seedAll.results", "scopeKind": "class", "description": "unavailable"}, {"name": "skipped: res.skipped,", "scope": "seedAll.results", "scopeKind": "class", "description": "unavailable"}, {"name": "updated: res.updated,", "scope": "seedAll.results", "scopeKind": "class", "description": "unavailable"}]}