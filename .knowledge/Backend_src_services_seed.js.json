{"is_source_file": true, "format": "JavaScript", "description": "This file is a JavaScript module containing functions for seeding entities (users, organizations, resources) into a database, involving validation, normalization, and bulk upsert operations. It also includes utility functions for file system operations to locate configuration files and load JSON data related to these entities.", "external_files": ["../db"], "external_methods": ["query", "ensureSchema"], "published": ["ENTITIES", "loadEntityFromProjdefn", "seedEntity", "seedAll"], "classes": [], "methods": [{"name": "isUUIDv4(str)", "description": "Checks if a string is a valid UUID v4.", "scope": "", "scopeKind": ""}, {"name": "isEmail(str)", "description": "Performs a basic check to determine if a string is in email format.", "scope": "", "scopeKind": ""}, {"name": "toISODateOrNow(val)", "description": "Converts a value to an ISO date or current date if invalid.", "scope": "", "scopeKind": ""}, {"name": "chunkArray(arr, size)", "description": "Splits an array into chunks of a specified size.", "scope": "", "scopeKind": ""}, {"name": "findProjdefnRoot()", "description": "Ascends directory tree to locate a '.projdefn' directory.", "scope": "", "scopeKind": ""}, {"name": "walkDirCollectJsonFiles(dirPath)", "description": "Recursively collects all JSON files from a directory.", "scope": "", "scopeKind": ""}, {"name": "loadEntityFromProjdefn(entity)", "description": "Loads entity data arrays from JSON files within the project configuration directory.", "scope": "", "scopeKind": ""}, {"name": "validateAndNormalize(entity, records)", "description": "Validates and normalizes raw records for entities, returning valid records and errors.", "scope": "", "scopeKind": ""}, {"name": "buildValuesPlaceholders(rows, cols)", "description": "Builds parameterized SQL placeholders for bulk inserts.", "scope": "", "scopeKind": ""}, {"name": "upsertOrganizations(records)", "description": "Performs bulk upsert of organization records into the database.", "scope": "", "scopeKind": ""}, {"name": "upsertUsersById(records)", "description": "Performs bulk upsert of user records with known IDs.", "scope": "", "scopeKind": ""}, {"name": "upsertUsersByEmail(records)", "description": "Performs bulk upsert of user records identified by email addresses, generating IDs when missing.", "scope": "", "scopeKind": ""}, {"name": "upsertResources(records)", "description": "Bulk upsert for resource entities into the database.", "scope": "", "scopeKind": ""}, {"name": "seedEntity(entity, bodyRecords)", "description": "Seeds a specific entity type, either from provided records or by loading from configuration files, with validation and upsert logic.", "scope": "", "scopeKind": ""}, {"name": "seedAll(payloadMap)", "description": "Sequentially seeds all entity types in the order: organizations, users, resources.", "scope": "", "scopeKind": ""}], "calls": ["query", "ensureSchema"], "search-terms": ["seed", "bulk upsert", "entities", "loadEntityFromProjdefn", "validateAndNormalize", "JSON files", "organization", "user", "resource", "schema"], "state": 2, "file_id": 15, "knowledge_revision": 40, "git_revision": "cdc4522b98f6436807c26ddb5ccd4c7d40f42e85", "revision_history": [{"31": ""}, {"40": "cdc4522b98f6436807c26ddb5ccd4c7d40f42e85"}], "ctags": [{"_type": "tag", "name": "ENTITIES", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^  ENTITIES,$/", "language": "JavaScript", "kind": "field", "scope": "module.exports", "scopeKind": "class"}, {"_type": "tag", "name": "ENTITIES", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^const ENTITIES = ['users', 'organizations', 'resources'];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "buildValuesPlaceholders", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function buildValuesPlaceholders(rows, cols) {$/", "language": "JavaScript", "kind": "function", "signature": "(rows, cols)"}, {"_type": "tag", "name": "chunkArray", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function chunkArray(arr, size) {$/", "language": "JavaScript", "kind": "function", "signature": "(arr, size)"}, {"_type": "tag", "name": "errors", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^      errors: res.errors,$/", "language": "JavaScript", "kind": "property", "scope": "seedAll.results", "scopeKind": "class"}, {"_type": "tag", "name": "findProjdefnRoot", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function findProjdefnRoot() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "fs", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^const fs = require('fs');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "inserted", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^      inserted: res.inserted,$/", "language": "JavaScript", "kind": "property", "scope": "seedAll.results", "scopeKind": "class"}, {"_type": "tag", "name": "isEmail", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function isEmail(str) {$/", "language": "JavaScript", "kind": "function", "signature": "(str)"}, {"_type": "tag", "name": "isUUIDv4", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function isUUIDv4(str) {$/", "language": "JavaScript", "kind": "function", "signature": "(str)"}, {"_type": "tag", "name": "loadEntityFromProjdefn", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function loadEntityFromProjdefn(entity) {$/", "language": "JavaScript", "kind": "function", "signature": "(entity)"}, {"_type": "tag", "name": "path", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^const path = require('path');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "results", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^    results[entity] = {$/", "language": "JavaScript", "kind": "class", "scope": "seedAll", "scopeKind": "class"}, {"_type": "tag", "name": "seedAll", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^async function seedAll(payloadMap) {$/", "language": "JavaScript", "kind": "function", "signature": "(payloadMap)"}, {"_type": "tag", "name": "seedEntity", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^async function seedEntity(entity, bodyRecords) {$/", "language": "JavaScript", "kind": "function", "signature": "(entity, bodyRecords)"}, {"_type": "tag", "name": "skipped", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^      skipped: res.skipped,$/", "language": "JavaScript", "kind": "property", "scope": "seedAll.results", "scopeKind": "class"}, {"_type": "tag", "name": "toISODateOrNow", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function toISODateOrNow(val) {$/", "language": "JavaScript", "kind": "function", "signature": "(val)"}, {"_type": "tag", "name": "updated", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^      updated: res.updated,$/", "language": "JavaScript", "kind": "property", "scope": "seedAll.results", "scopeKind": "class"}, {"_type": "tag", "name": "upsertOrganizations", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^async function upsertOrganizations(records) {$/", "language": "JavaScript", "kind": "function", "signature": "(records)"}, {"_type": "tag", "name": "upsertResources", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^async function upsertResources(records) {$/", "language": "JavaScript", "kind": "function", "signature": "(records)"}, {"_type": "tag", "name": "upsertUsersByEmail", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^async function upsertUsersByEmail(records) {$/", "language": "JavaScript", "kind": "function", "signature": "(records)"}, {"_type": "tag", "name": "upsertUsersById", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^async function upsertUsersById(records) {$/", "language": "JavaScript", "kind": "function", "signature": "(records)"}, {"_type": "tag", "name": "validateAndNormalize", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function validateAndNormalize(entity, records) {$/", "language": "JavaScript", "kind": "function", "signature": "(entity, records)"}, {"_type": "tag", "name": "walkDirCollectJsonFiles", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function walkDirCollectJsonFiles(dirPath) {$/", "language": "JavaScript", "kind": "function", "signature": "(dirPath)"}], "hash": "7ac749db54e322664077d60afebc9016", "format-version": 4, "code-base-name": "Backend", "filename": "Backend/src/services/seed.js", "fields": [{"name": "ENTITIES,", "scope": "module.exports", "scopeKind": "class", "description": "unavailable"}, {"name": "errors: res.errors,", "scope": "seedAll.results", "scopeKind": "class", "description": "unavailable"}, {"name": "inserted: res.inserted,", "scope": "seedAll.results", "scopeKind": "class", "description": "unavailable"}, {"name": "skipped: res.skipped,", "scope": "seedAll.results", "scopeKind": "class", "description": "unavailable"}, {"name": "updated: res.updated,", "scope": "seedAll.results", "scopeKind": "class", "description": "unavailable"}]}