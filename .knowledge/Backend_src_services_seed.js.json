{"is_source_file": true, "format": "JavaScript", "description": "This file contains seed data management functions for a backend application, including loading entity data from JSON files, validating, normalizing, and upserting entities like users, organizations, and resources into a database. It exposes functions for seeding individual entities, all entities in order, and retrieving seed counts.", "external_files": ["../db"], "external_methods": ["query", "ensureSchema"], "published": ["ENTITIES", "loadEntityFromProjdefn", "seedEntity", "seedAll", "getSeedCounts"], "classes": [], "methods": [{"name": "isUUIDv4(str)", "description": "Checks if a string is a valid UUID version 4.", "scope": "", "scopeKind": ""}, {"name": "isEmail(str)", "description": "Performs a basic validation check for an email string.", "scope": "", "scopeKind": ""}, {"name": "toISODateOrNow(val)", "description": "Converts a value to ISO Date; defaults to current date if invalid.", "scope": "", "scopeKind": ""}, {"name": "chunkArray(arr, size)", "description": "Splits an array into chunks of specified size.", "scope": "", "scopeKind": ""}, {"name": "findProjdefnRoot()", "description": "Ascends directories to find a '.projdefn' folder or return null if not found.", "scope": "", "scopeKind": ""}, {"name": "walkDirCollectJsonFiles(dirPath)", "description": "Recursively collects all JSON files from a directory.", "scope": "", "scopeKind": ""}, {"name": "loadEntityFromProjdefn(entity)", "description": "Loads and concatenates JSON array data for a specific entity from project JSON files.", "scope": "", "scopeKind": ""}, {"name": "validateAndNormalize(entity, records)", "description": "Validates and normalizes records for specified entities, returning valid data and errors.", "scope": "", "scopeKind": ""}, {"name": "buildValuesPlaceholders(rows, cols)", "description": "Generates SQL parameter placeholders for bulk insertions.", "scope": "", "scopeKind": ""}, {"name": "hasColumn(table, column)", "description": "Checks if a specific column exists on a table in the database schema.", "scope": "", "scopeKind": ""}, {"name": "getAnyOrganizationId()", "description": "Fetches the first organization ID based on creation date as fallback.", "scope": "", "scopeKind": ""}, {"name": "upsertOrganizations(records)", "description": "Performs bulk upsert (insert or update) for organization records.", "scope": "", "scopeKind": ""}, {"name": "upsertUsersById(records)", "description": "Bulk upsert users that have existing IDs, updating or inserting as necessary.", "scope": "", "scopeKind": ""}, {"name": "upsertUsersByEmail(records)", "description": "Bulk upsert users without IDs, using email as key, generating IDs if missing.", "scope": "", "scopeKind": ""}, {"name": "upsertResources(records)", "description": "Bulk upsert resource records, handling optional organizationId with fallback.", "scope": "", "scopeKind": ""}, {"name": "seedEntity(entity, bodyRecords)", "description": "Seeds a single entity type by validating, normalizing, and performing bulk database operations.", "scope": "", "scopeKind": ""}, {"name": "seedAll(payloadMap)", "description": "Seeds all entities (organizations, users, resources) in a specific order.", "scope": "", "scopeKind": ""}, {"name": "getSeedCounts()", "description": "Retrieves counts of seeded entities for verification.", "scope": "", "scopeKind": ""}], "calls": ["query", "ensureSchema", "loadEntityFromProjdefn", "validateAndNormalize", "upsertOrganizations", "upsertUsersById", "upsertUsersByEmail", "upsertResources"], "search-terms": ["seed", "seedEntity", "seedAll", "loadEntityFromProjdefn", "upsertResources", "upsertUsers", "upsertOrganizations", "json files", "json seed", "project directory", "database schema"], "state": 2, "file_id": 15, "knowledge_revision": 114, "git_revision": "f22bb36c42a679c9970c3e0048b51e20ae9af1b8", "revision_history": [{"31": ""}, {"40": "cdc4522b98f6436807c26ddb5ccd4c7d40f42e85"}, {"79": "cdc4522b98f6436807c26ddb5ccd4c7d40f42e85"}, {"106": "dba4240178822cb1fce1c0a7a0aa20147e9b5078"}, {"113": "f22bb36c42a679c9970c3e0048b51e20ae9af1b8"}, {"114": "f22bb36c42a679c9970c3e0048b51e20ae9af1b8"}], "ctags": [{"_type": "tag", "name": "ENTITIES", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^  ENTITIES,$/", "language": "JavaScript", "kind": "field", "scope": "module.exports", "scopeKind": "class"}, {"_type": "tag", "name": "ENTITIES", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^const ENTITIES = ['users', 'organizations', 'resources'];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "bcrypt", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^const bcrypt = require('bcryptjs');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "buildValuesPlaceholders", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function buildValuesPlaceholders(rows, cols) {$/", "language": "JavaScript", "kind": "function", "signature": "(rows, cols)"}, {"_type": "tag", "name": "chunkArray", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function chunkArray(arr, size) {$/", "language": "JavaScript", "kind": "function", "signature": "(arr, size)"}, {"_type": "tag", "name": "counts", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^  const counts = {$/", "language": "JavaScript", "kind": "class", "scope": "getSeedCounts", "scopeKind": "class"}, {"_type": "tag", "name": "errors", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^      errors: res.errors,$/", "language": "JavaScript", "kind": "property", "scope": "seedAll.results", "scopeKind": "class"}, {"_type": "tag", "name": "findProjdefnRoot", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function findProjdefnRoot() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "fs", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^const fs = require('fs');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "getAnyOrganizationId", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^async function getAnyOrganizationId() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "getSeedCounts", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^async function getSeedCounts() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "hasColumn", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^async function hasColumn(table, column) {$/", "language": "JavaScript", "kind": "function", "signature": "(table, column)"}, {"_type": "tag", "name": "inserted", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^      inserted: res.inserted,$/", "language": "JavaScript", "kind": "property", "scope": "seedAll.results", "scopeKind": "class"}, {"_type": "tag", "name": "isEmail", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function isEmail(str) {$/", "language": "JavaScript", "kind": "function", "signature": "(str)"}, {"_type": "tag", "name": "isUUIDv4", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function isUUIDv4(str) {$/", "language": "JavaScript", "kind": "function", "signature": "(str)"}, {"_type": "tag", "name": "loadEntityFromProjdefn", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function loadEntityFromProjdefn(entity) {$/", "language": "JavaScript", "kind": "function", "signature": "(entity)"}, {"_type": "tag", "name": "organizations", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^    organizations: (orgs.rows[0] && orgs.rows[0].c) || 0,$/", "language": "JavaScript", "kind": "property", "scope": "getSeedCounts.counts", "scopeKind": "class"}, {"_type": "tag", "name": "path", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^const path = require('path');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "resources", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^    resources: (resources.rows[0] && resources.rows[0].c) || 0,$/", "language": "JavaScript", "kind": "property", "scope": "getSeedCounts.counts", "scopeKind": "class"}, {"_type": "tag", "name": "results", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^    results[entity] = {$/", "language": "JavaScript", "kind": "class", "scope": "seedAll", "scopeKind": "class"}, {"_type": "tag", "name": "seedAll", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^async function seedAll(payloadMap) {$/", "language": "JavaScript", "kind": "function", "signature": "(payloadMap)"}, {"_type": "tag", "name": "seedEntity", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^async function seedEntity(entity, bodyRecords) {$/", "language": "JavaScript", "kind": "function", "signature": "(entity, bodyRecords)"}, {"_type": "tag", "name": "skipped", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^      skipped: res.skipped,$/", "language": "JavaScript", "kind": "property", "scope": "seedAll.results", "scopeKind": "class"}, {"_type": "tag", "name": "toISODateOrNow", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function toISODateOrNow(val) {$/", "language": "JavaScript", "kind": "function", "signature": "(val)"}, {"_type": "tag", "name": "updated", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^      updated: res.updated,$/", "language": "JavaScript", "kind": "property", "scope": "seedAll.results", "scopeKind": "class"}, {"_type": "tag", "name": "upsertOrganizations", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^async function upsertOrganizations(records) {$/", "language": "JavaScript", "kind": "function", "signature": "(records)"}, {"_type": "tag", "name": "upsertResources", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^async function upsertResources(records) {$/", "language": "JavaScript", "kind": "function", "signature": "(records)"}, {"_type": "tag", "name": "upsertUsersByEmail", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^async function upsertUsersByEmail(records) {$/", "language": "JavaScript", "kind": "function", "signature": "(records)"}, {"_type": "tag", "name": "upsertUsersById", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^async function upsertUsersById(records) {$/", "language": "JavaScript", "kind": "function", "signature": "(records)"}, {"_type": "tag", "name": "users", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^    users: (users.rows[0] && users.rows[0].c) || 0,$/", "language": "JavaScript", "kind": "property", "scope": "getSeedCounts.counts", "scopeKind": "class"}, {"_type": "tag", "name": "validateAndNormalize", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function validateAndNormalize(entity, records) {$/", "language": "JavaScript", "kind": "function", "signature": "(entity, records)"}, {"_type": "tag", "name": "walkDirCollectJsonFiles", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-284073-286483/Backend/src/services/seed.js", "pattern": "/^function walkDirCollectJsonFiles(dirPath) {$/", "language": "JavaScript", "kind": "function", "signature": "(dirPath)"}], "hash": "e3163c86652955b435638a3e5067de9b", "format-version": 4, "code-base-name": "Backend", "filename": "Backend/src/services/seed.js", "fields": [{"name": "ENTITIES,", "scope": "module.exports", "scopeKind": "class", "description": "unavailable"}, {"name": "errors: res.errors,", "scope": "seedAll.results", "scopeKind": "class", "description": "unavailable"}, {"name": "inserted: res.inserted,", "scope": "seedAll.results", "scopeKind": "class", "description": "unavailable"}, {"name": "organizations: (orgs.rows[0] && orgs.rows[0].c) || 0,", "scope": "getSeedCounts.counts", "scopeKind": "class", "description": "unavailable"}, {"name": "resources: (resources.rows[0] && resources.rows[0].c) || 0,", "scope": "getSeedCounts.counts", "scopeKind": "class", "description": "unavailable"}, {"name": "skipped: res.skipped,", "scope": "seedAll.results", "scopeKind": "class", "description": "unavailable"}, {"name": "updated: res.updated,", "scope": "seedAll.results", "scopeKind": "class", "description": "unavailable"}, {"name": "users: (users.rows[0] && users.rows[0].c) || 0,", "scope": "getSeedCounts.counts", "scopeKind": "class", "description": "unavailable"}]}